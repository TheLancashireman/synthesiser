Synth keyboard scanner


Arduino nano:
 Pins d2 - d9 = 8-way input
 Pins d10-d13, a0-a3 = 8-way output - each pin (driven low) scans a set of 8 keys
     ==> up to 64 keys (60 key keyboard plus 4 switches)
 Alternatively, use pins d10-d12 to drive a 3-to-8-way demux chip (74138?)
     ==> could use d13 to select 1 of 2 demux chips to increase range

 Can also use d2-d9 as data bus to a latch for driving 8 LEDs. Use another pin (or a demux line) to latch.

 Use any remaining A pins for potentiometers (pitch bend etc.)

 scan code

	foreach column 0..COLMAX
		set column drive low
		wait settling time
		for each row 0..ROWMAX
			read row input
			if row key pressed (input=0)
				if keycount[column,row] < max
					keycount[column,row]++
					if keycount[column,row] >= max
						sendkeydown(column,row)
			else
				if keycount[column,row] >= max
					sendkeyup(column, row)
                keycount[column,row] = 0
